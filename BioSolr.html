---
layout: default
title: BioSolr
group: "in_local_navigation"
order: 2
---
<div class="blurb">
	<h4>A BioSolr Ontology Expansion plugin for Solr</h4>
	<p>This is a short interactive introduction to the BioSolr Ontology Expansion plugin for Solr.</p>
	<p>In this tutorial you will learn how to:</p>
	<ul>
		<li><a href="#install_solr">Install Solr</a></li>
		<li><a href="#index_sample_data">Index some example data with embedded ontology annotations</a></li>
		<li><a href="#search_data">Use an example web application to search this data</a></li>
		<li><a href="#install_biosolr_plugins">Install BioSolr plugins to ontology-enrich your Solr index</a></li>
		<li><a href="#configure_biosolr"></a>Configure BioSolr</li>
		<li><a href="#ontology_powered_search">Perform ontology-powered searches</a></li>
	</ul>
	<h5>Prerequisites</h5>
	<p>Java 8 - both Solr and the example web application rely on Java 8 to run.</p>
	<h5 id="install_solr">Install Solr</h5>
	<p>Download Solr from <a href="http://lucene.apache.org/solr/" target="_blank">http://lucene.apache.org/solr/</a> (Pick .tgz or .zip file as you prefer)</p>
	<p>Unpack the Solr download into your preferred directory - for this demo, we're going to use ~/Applications/solr-5.3.1/</p>
	<p>Once you've done this, verify you can startup Solr:</p>
	<code>>: cd ~/Applications/solr-5.3.1/</code><br/>
	<code>>: bin/solr start</code>
	<p>Now open a browser and check we can see the Solr admin page at <a href="http://localhost:8983/" target="_blank">http://localhost:8983/</a></p>
	<p>Now we're happy we can run Solr, so let's shut down our Solr server again...</p>
	<code>>: bin/solr stop</code>
	<p>...and now get the extra BioSolr stuff. We'll be using this later in the tutorial</p>
	<p>Check out the code for this demo into your preferred directory - we're going to be using ~/Projects/:</p>
	<code>>: cd ~/Projects</code><br/>
	<code>>: git clone git@github.com:flaxsearch/BioSolr.git</code><br/>
	<code>>: cd BioSolr/swat4ls_demo</code>
	<p>We've supplied the required configuration to get us up and running quickly, so let's start a new Solr instance that uses this config:</p>
	<code>>: cd ~/Projects/BioSolr/swat4ls_demo</code><br/>
	<code>>: export SOLR_DIR=~/Applications/solr-5.3.1</code><br/>
	<code>>: solr-start.sh</code>
	<p>Now reload your page at <a href="http://localhost:8983/" target="_blank">http://localhost:8983/</a> - this time, you should see a new documents core. If so, great! Now we're ready to start indexing some data.</p>
	<h5 id="index_sample_data">Index some example data with embedded ontology annotations</h5>
	<p>We've supplied some sample data to demonstrate how BioSolr can index information annotated with ontology terms. 
		This data is stored in the file <i>data/gwas-catalog-annotation-data.csv</i> - you can open this file in Excel and take a 
		look at it if you like. You'll see this file contains a column <i>efo_uri</i> which contains annotations to the Experimental 
		Factor Ontology.
	</p>
	<p> For reference: Data is taken from the GWAS Catalog: <a href="http://www.ebi.ac.uk/gwas" target="_blank">http://www.ebi.ac.uk/gwas</a> Ontology information is from the 
		Experimental Factor Ontology: <a href="http://www.ebi.ac.uk/efo" target="_blank">http://www.ebi.ac.uk/efo</a>
	</p>
	<p>Now let's index this data. You can upload CSV files directly to Solr using curl:</p>
	<code>>: curl http://localhost:8983/solr/documents/update --data-binary @data/gwas-catalog-annotation-data.csv -H 'Content-type:application/csv'</code><br/>
	<code>>: curl http://localhost:8983/solr/documents/update --data '<commit/>' -H 'Content-type:text/xml; charset=utf-8'</code>
	<p>The first command here uploads the data, the second one commits the changes and makes your newly indexed documents visible.</p>
	<p>Now, if you open the admin interface once more and look at the overview of the documents 
		core <a href="http://localhost:8983/solr/#/documents" target="_blank">http://localhost:8983/solr/#/documents</a>, you should see we now have 26,385 documents in our index.
	</p>
	<p>We can also inspect some of the data by browsing to the query page <a href="http://localhost:8983/solr/#/documents/query" target="_blank">http://localhost:8983/solr/#/documents/query</a>
		and running a standard query - you can see that the documents in our index correspond to rows in our spreadsheet.
	</p>
	<h5 id="search_data">Use an example web application to search this data</h5>
	<p>Next, we've supplied you with a simple web application to search our new Solr index. Let's try running this.</p>
	<code>>: cd ~/Projects/BioSolr/swat4ls_demo/tools</code><br/>
	<code>>: java -jar swat4ls-webapp-1.0-SNAPSHOT.jar server webapp.yml</code>
	<p>You should see a bunch of logging information as the web application starts up. If all goes well, you'll eventually see a message like this:</p>
	<code>INFO  [2015-12-06 18:50:49,002] org.eclipse.jetty.server.Server: Started @1637ms</code>
	<p>Now we can open up our example application by browsing to <a href="http://localhost:8080/" target="_blank">http://localhost:8080/.</a></p>
	<p>Let's try some example searches. Most of the GWAS data is concerned with the links between SNPs and diseases - so let's try a search for <i>Lung cancer</i>. 
		Looks like we get 31 results, all containing lung cancer in the title or the association line, so for example:</p>
	<ol><li>Deciphering the impact of common genetic variation on lung cancer risk: a genome-wide association study. Broderick P - Cancer Res. rs4254535 is associated with <i>Lung cancer</i></li></ol>
	<p>But what if we want all lung diseases? We could try searching for <i>lung disease</i> - but this only gives us 3 results, 
		probably not what we want. We can try just searching for <i>lung</i>, which looks a little better - 49 results this time, some 
		of them are lung cancer but there's also stuff about lung function, so this isn't ideal either.
	</p>
	<p>Let's try another example. We could search for <i>schizophrenia</i> - this gives us nice results, we get 51 documents that seems to 
		be annotated to schizophrenia or treatment responses in schizophrenia. But what if we want other mental disorders? If we 
		search for <i>mental disorder</i> we get no results.
	</p>
	<p>BioSolr's ontology expansion plugin will help us improve these search results a lot. So let's kill our search web application and move on to installing BioSolr.</p>
	
</div><!-- /.blurb -->
